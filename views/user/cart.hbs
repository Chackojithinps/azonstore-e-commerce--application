<!--====== App Content ======-->

<div class="app-content">

    <!--====== Section 1 ======-->
    <div class="u-s-p-y-60">

        <!--====== Section Content ======-->
        <div class="section__content">
            <div class="container">
                <div class="breadcrumb">
                    <div class="breadcrumb__wrap">
                        <ul class="breadcrumb__list">
                            <li class="has-separator">

                                <a href="/">Home</a>
                            </li>
                            <li class="is-marked">

                                <a href="cart">Cart</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--====== End - Section 1 ======-->


    <!--====== Section 2 ======-->
    <div class="u-s-p-b-60">

        <!--====== Section Intro ======-->
        <div class="section__intro u-s-m-b-60">
            <div class="container">
                <div class="row">
                    <div class="col-lg-12">
                        <div class="section__text-wrap">
                            <h1 class="section__heading u-c-secondary">SHOPPING CART</h1>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!--====== End - Section Intro ======-->


        <!--====== Section Content ======-->
        <div class="section__content">
           
            <div class="container">
                <div class="row">
                    <div class="col-lg-12 col-md-12 col-sm-12 u-s-m-b-30">
                        <div class="table-responsive">
                            <table class="table-p">
                                <tbody>
                                {{#each userList}}
                                    <!--====== Row ======-->
                                 
                                    <tr>
                                        <td>
                                            <div class="table-p__box">
                                                <div class="table-p__img-wrap">

                                                    <img class="u-img-fluid"
                                                        src="http://res.cloudinary.com/dmuikdem0/image/upload/v1684072203/{{this.productImage.[0]}}.jpg" alt="">
                                                </div>
                                                <div class="table-p__info">

                                                    <span class="table-p__name">

                                                        <a href="href="singleProduct?id={{this._id}}"">{{this.name}}
                                                            </a></span>

                                                    <span class="table-p__category">

                                                        <a href="shop-side-version-2.html">Electronics</a></span>
                                                    <ul class="table-p__variant-list">
                                                        <li>

                                                            <span>Size: 22</span>
                                                        </li>
                                                        <li>

                                                            <span>Color: Red</span>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </td>
                                        <td>

                                     <span class="table-p__price" id="{{_id}}_priceProduct">₹{{price}}</span>
                                        </td>
                                        <td>
                                            <div class="table-p__input-counter-wrap">

                                                <!--====== Input Counter ======-->
                                                <div class="input-counter">

                                                  {{!-- <a href="minus?id={{this._id}}"><span class="input-counter__minus fas fa-minus" id="value" onclick="decrementValue()" ></span></a>
                                                  <a href="minus?id={{this._id}}"><span class="input-counter__minus fas fa-minus" data-min="1" data-max="1000" ></span></a> --}}
                                                   
                                                  <a  id="decBtn" onclick="decrease('{{_id}}','{{_id}}_data-value')"><span class="input-counter__minus fas fa-minus"></span></a>

                                                    <input id="{{_id}}_data-value" min="1" disabled class="input-counter__text input-counter--text-primary-style"
                                                    type="text" value="{{this.quantity}}">

                                                     {{!-- <a href="plus?id={{this._id}}"><span class="input-counter__plus fas fa-plus"></span></a> --}}
                                                  <a id="decBtn" onclick="increase('{{_id}}','{{_id}}_data-value')"><span class="input-counter__plus fas fa-plus"></span></a>

                                                  


                                                </div>
                                                <!--====== End - Input Counter ======-->
                                            </div>
                                        </td>
                                        <td>
                                            <div class="table-p__del-wrap">
                                                {{!-- <a id="decBtn" onclick="delete('{{_id}}')><span class="far fa-trash-alt table-p__delete-link"></span></a> --}}
                                                {{!-- <a  "></a> --}}
                                                  <a onclick="deleteProduct('{{_id}}')"><span class="far fa-trash-alt table-p__delete-link"</span></a>

                                            </div>
                                        </td>
                                    </tr>
                                    <!--====== End - Row ======-->
                                    {{/each}}
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="col-lg-12">
                        <div class="route-box">
                            <div class="route-box__g1">

                                <a class="route-box__link" href="shop"><i
                                        class="fas fa-long-arrow-alt-left"></i>

                                    <span>CONTINUE SHOPPING</span></a>
                            </div>
                            <div class="route-box__g2">

                                <a class="route-box__link" href="cart.html"><i class="fas fa-trash"></i>

                                    <span>CLEAR CART</span></a>

                                <a class="route-box__link" href="cart.html"><i class="fas fa-sync"></i>

                                    <span>UPDATE CART</span></a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!--====== End - Section Content ======-->
    </div>
    <!--====== End - Section 2 ======-->


    <!--====== Section 3 ======-->
    <div class="u-s-p-b-60">

        <!--====== Section Content ======-->
        <div class="section__content">
            <div class="container">
                <div class="row">
                    <div class="col-lg-12 col-md-12 col-sm-12 u-s-m-b-30 ">
                        <form class="f-cart" action="/checkout" method="">
                            <div class="row">
                              
                            
                                <div class="col-lg-4 col-md-6 u-s-m-b-30" style="margin-left: auto;">
                                    <div class="f-cart__pad-box">
                                        <div class="u-s-m-b-30">
                                            <table class="f-cart__table">
                                                <tbody>
                                                    <tr>
                                                        <td>SHIPPING</td>
                                                        <td class="shipping-free">FREE</td>
                                                    </tr>
                                                    <tr>
                                                        <td>TAX</td>
                                                        <td>₹0.00</td>
                                                    </tr>
                                                    <tr>
                                                        <td>SUBTOTAL</td>
                                                        <td id="grandTotal1">₹{{subTotal}}</td>
                                                    </tr>
                                                    <tr>
                                                        <td>GRAND TOTAL</td>
                                                        <td id="grandTotal2">₹{{subTotal}}</td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                        <div>

                                            <button class="btn btn--e-brand-b-2" type="submit"> PROCEED TO
                                                CHECKOUT</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <!--====== End - Section Content ======-->
    </div>
    <!--====== End - Section 3 ======-->
</div>
<!--====== End - App Content ======-->


<!--====== Main Footer ======-->
<footer>
    <div class="outer-footer">
        <div class="container">
            <div class="row">
                <div class="col-lg-4 col-md-6">
                    <div class="outer-footer__content u-s-m-b-40">

                        <span class="outer-footer__content-title">Contact Us</span>
                        <div class="outer-footer__text-wrap"><i class="fas fa-home"></i>

                            <span>4247 Ashford Drive Virginia VA-20006 USA</span>
                        </div>
                        <div class="outer-footer__text-wrap"><i class="fas fa-phone-volume"></i>

                            <span>(+0) 900 901 904</span>
                        </div>
                        <div class="outer-footer__text-wrap"><i class="far fa-envelope"></i>

                            <span>contact@domain.com</span>
                        </div>
                        <div class="outer-footer__social">
                            <ul>
                                <li>

                                    <a class="s-fb--color-hover" href="#"><i class="fab fa-facebook-f"></i></a>
                                </li>
                                <li>

                                    <a class="s-tw--color-hover" href="#"><i class="fab fa-twitter"></i></a>
                                </li>
                                <li>

                                    <a class="s-youtube--color-hover" href="#"><i class="fab fa-youtube"></i></a>
                                </li>
                                <li>

                                    <a class="s-insta--color-hover" href="#"><i class="fab fa-instagram"></i></a>
                                </li>
                                <li>

                                    <a class="s-gplus--color-hover" href="#"><i class="fab fa-google-plus-g"></i></a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="col-lg-4 col-md-6">
                    <div class="row">
                        <div class="col-lg-6 col-md-6">
                            <div class="outer-footer__content u-s-m-b-40">

                                <span class="outer-footer__content-title">Information</span>
                                <div class="outer-footer__list-wrap">
                                    <ul>
                                        <li>

                                            <a href="cart.html">Cart</a>
                                        </li>
                                        <li>

                                            <a href="dashboard.html">Account</a>
                                        </li>
                                        <li>

                                            <a href="shop-side-version-2.html">Manufacturer</a>
                                        </li>
                                        <li>

                                            <a href="dash-payment-option.html">Finance</a>
                                        </li>
                                        <li>

                                            <a href="shop-side-version-2.html">Shop</a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-6 col-md-6">
                            <div class="outer-footer__content u-s-m-b-40">
                                <div class="outer-footer__list-wrap">

                                    <span class="outer-footer__content-title">Our Company</span>
                                    <ul>
                                        <li>

                                            <a href="about.html">About us</a>
                                        </li>
                                        <li>

                                            <a href="contact.html">Contact Us</a>
                                        </li>
                                        <li>

                                            <a href="index.html">Sitemap</a>
                                        </li>
                                        <li>

                                            <a href="dash-my-order.html">Delivery</a>
                                        </li>
                                        <li>

                                            <a href="shop-side-version-2.html">Store</a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-4 col-md-12">
                    <div class="outer-footer__content">

                        <span class="outer-footer__content-title">Join our Newsletter</span>
                        <form class="newsletter">
                            <div class="u-s-m-b-15">
                                <div class="radio-box newsletter__radio">

                                    <input type="radio" id="male" name="gender">
                                    <div class="radio-box__state radio-box__state--primary">

                                        <label class="radio-box__label" for="male">Male</label>
                                    </div>
                                </div>
                                <div class="radio-box newsletter__radio">

                                    <input type="radio" id="female" name="gender">
                                    <div class="radio-box__state radio-box__state--primary">

                                        <label class="radio-box__label" for="female">Female</label>
                                    </div>
                                </div>
                            </div>
                            <div class="newsletter__group">

                                <label for="newsletter"></label>

                                <input class="input-text input-text--only-white" type="text" id="newsletter"
                                    placeholder="Enter your Email">

                                <button class="btn btn--e-brand newsletter__btn" type="submit">SUBSCRIBE</button>
                            </div>

                            <span class="newsletter__text">Subscribe to the mailing list to receive updates on
                                promotions, new arrivals, discount and coupons.</span>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="lower-footer">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <div class="lower-footer__content">
                        <div class="lower-footer__copyright">

                            <span>Copyright © 2018</span>

                            <a href="index.html">Reshop</a>

                            <span>All Right Reserved</span>
                        </div>
                        <div class="lower-footer__payment">
                            <ul>
                                <li><i class="fab fa-cc-stripe"></i></li>
                                <li><i class="fab fa-cc-paypal"></i></li>
                                <li><i class="fab fa-cc-mastercard"></i></li>
                                <li><i class="fab fa-cc-visa"></i></li>
                                <li><i class="fab fa-cc-discover"></i></li>
                                <li><i class="fab fa-cc-amex"></i></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</footer>
</div>

{{!-- 
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/2.1.2/sweetalert.min.css" integrity="sha512-bVr0haDkM7GdjyT8zH/Lh3qOYgYbNNaZf8C0Q2Ovob19fNt7PsmruhNqbUTTq3/BLsUEt7g/8XhCgb2vJ/DyPQ==" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/2.1.2/sweetalert.min.js" integrity="sha512-OKzpC6b4dG+4FwUaYJUQzf6Ex9+cWW0BBv+D31VVy0DCJyR12+D2QHUp/+YiYkrJ0Z9+YPp3c3I/8H2PzFgrgA==" crossorigin="anonymous"></script>
 --}}
<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
<script>
  function increase(id, quantity) {
    const check = document.getElementById(`${id}_data-value`).value;
    console.log(check)
    console.log(quantity)
    $.ajax({
      url: '/plus',
      method: 'patch',
      data: {
        id: id,
        check: check
      },
      success: (response) => {
        console.log(response.msg)
        if (response.msg == "failed") {
        console.log("Hello")

          swal({
            icon: 'error',
            title: 'Oops...',
            text: 'the stoke limit reach!',
          });
        } else {
          
          $('#stoke').val(response.stock);
          $('#grandTotal1').text("₹"+response.subTotal)
          $('#grandTotal2').text("₹"+response.subTotal)
          $(`#${id}_priceProduct`).html("₹"+response.price)
           
          $(`#${id}_data-value`).val(response.userCart1);
          $(`#price-total_${id}`).html('<i class="fa fa-indian-rupee-sign fa-xl" style="color: #000000;"></i>' + response.totalPrice);
          $(`#${id}_price_sub`).html('<i class="fa fa-indian-rupee-sign fa" style="color: #000000;"></i>' + response.subPrice);
        }
      },
      error: (error) => {
        alert(error);
      }
    });
  }



 function decrease(id, quantity) {
    const check = document.getElementById(`${id}_data-value`).value;
    console.log(check)

    $.ajax({
      url: '/minus',
      method: 'patch',
      data: {
        id: id,
        check: check
      },
      success: (response) => {
  
        if (response.success == false) {
          Swal.fire({
            icon: 'error',
            title: 'Oops...',
            text: 'the stoke limit reach!',
          });
        } else {
         //  $('#stoke').val(response.stock);
       $('#grandTotal2').text("₹"+response.subTotal)
       $('#grandTotal1').text("₹"+response.subTotal)
          $(`#${id}_priceProduct`).html("₹"+response.price1)
           
          $(`#${id}_data-value`).val(response.userCart2);
        // $(`#price-total_${id}`).html('<i class="fa fa-indian-rupee-sign fa-xl" style="color: #000000;"></i>' + response.totalPrice);
         // $(`#${id}_price_sub`).html('<i class="fa fa-indian-rupee-sign fa" style="color: #000000;"></i>' + response.subPrice);
        }
      },
      error: (error) => {
        alert(error.message)
      }
    });
  }

function deleteProduct(id) {
    console.log("Hlloolfldfjdsfklsdfjidsf")
    $.ajax({
      url: '/deleteCartproduct',
      method: 'patch',
      data: {
        id: id,
      },
      success: (response) => {
       
        const swalWithBootstrapButtons = Swal.mixin({
          customClass: {
            confirmButton: 'btn btn-success',
            cancelButton: 'btn btn-danger'
          },
          buttonsStyling: false
        })

        swalWithBootstrapButtons.fire({
          title: 'Are you sure?',
          text: "You won't be able to revert this!",
          icon: 'warning',
          showCancelButton: true,
          confirmButtonText: 'Yes, delete it!',
          cancelButtonText: 'No, cancel!',
          reverseButtons: true
        }).then((result) => {
           setTimeout(()=>{
            location.reload()
        },2000)
        
          if (result.isConfirmed) {
            swalWithBootstrapButtons.fire(
              'Deleted!',
              'Your file has been deleted.',
              'success'
            )
          } else if (
            /* Read more about handling dismissals below */
            result.dismiss === Swal.DismissReason.cancel
          ) {
            swalWithBootstrapButtons.fire(
              'Cancelled',
              'Your imaginary file is safe :)',
              'error'
            )
          }
        })


      },
      error: (error) => {
        alert(error);
      }
    });
  }


</script>